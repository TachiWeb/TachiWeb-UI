<!-- Toolbar for My Library view -->
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/paper-menu/paper-menu.html">
<link rel="import" href="/bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="/src/element/paper-static-menu.html">
<link rel="import" href="/src/element/material-search.html">
<link rel="import" href="/src/element/paper-item-checkbox.html">
<link rel="import" href="/src/behavior/localized-app-behavior.html">

<dom-module id="view-library_tb">
    <template>
      <paper-menu-button id="filter_menu_button" dynamic-align>
  <paper-icon-button icon="icons:filter-list" class="dropdown-trigger"></paper-icon-button>
  <paper-static-menu id="filter_menu" class="dropdown-content">
      <!-- TODO LOCALE -->
      <paper-item-checkbox id="filter_downloaded" menu="[[_getMenu()]]" checked="{{filterDownloaded}}">[[localize('filter_downloaded')]]</paper-item-checkbox>
      <paper-item-checkbox id="filter_unread" menu="[[_getMenu()]]" checked="{{filterUnread}}">[[localize('filter_unread')]]</paper-item-checkbox>
      <paper-item id="filter_remove">[[localize('remove_filter')]]</paper-item>
  </paper-static-menu>
</paper-menu-button>
<paper-icon-button icon="icons:refresh"></paper-icon-button>
<paper-icon-button id="search_button" icon="icons:search"></paper-icon-button>
<material-search id="search_bar" value="{{librarySearchValue}}"></material-search>
<!-- Broadcast search event -->
<watch-object object="{{librarySearchValue}}" type="LibrarySearchEvent" internal-only></watch-object>
<!-- Sync filters to library -->
<watch-object object="{{filterDownloaded}}" type="LibraryFilterEvent" object-id="Downloaded"></watch-object>
<watch-object object="{{filterUnread}}" type="LibraryFilterEvent" object-id="Unread"></watch-object>
  </template>

    <script>
        Polymer({
            is: 'view-library_tb',
            properties: {
                librarySearch: {
                    type: String,
                    value: '',
                    notify: true
                }
            },
            behaviors: [LocalizedAppBehavior],
            listeners: {
                'search_button.tap': '_openSearch',
                'search_bar.search-closed': '_stopSearch',
                'filter_remove.tap': '_clearFilter'
            },
            _openSearch: function() {
                this.$.search_bar.open();
            },
            _stopSearch: function() {
                //Broadcast search stop
                this.librarySearchValue = "";
            },
            _getMenu: function() {
                return this.$.filter_menu_button;
            },
            _clearFilter: function() {
                this.$.filter_downloaded.checked = false;
                this.$.filter_unread.checked = false;
            }
        });
    </script>
</dom-module>
